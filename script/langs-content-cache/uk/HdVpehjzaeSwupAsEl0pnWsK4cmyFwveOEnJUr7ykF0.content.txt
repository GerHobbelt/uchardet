revision: 35268744
title: "\u0428\u0438\u0444\u0440 \u041F\u043B\u0435\u0439\u0444\u0435\u0440\u0430"
url: https://uk.wikipedia.org/wiki/%D0%A8%D0%B8%D1%84%D1%80_%D0%9F%D0%BB%D0%B5%D0%B9%D1%84%D0%B5%D1%80%D0%B0


---

Шифр Плейфера або квадрат Плейфера — ручна  симетрична техніка шифрування, в якій вперше використано  заміну біграм. Шифр у 1854 році винайшов англійський фізик Чарльз Вітстон, але він отримав ім'я лорда Лайона Плейфера, який просував використання цієї системи у державній службі. Цей метод передбачає шифрування пар символів (біграм) замість одиночних символів, як у  шифрі підстановки й у більш складних системах шифрування  Віженера. Через це шифр Плейфера стійкіший до злому методом частотного аналізу. Знаходження закономірності розподілу 26 х 26 = 676 можливих біграм потребує суттєво більших зусиль і обсягу зашифрованого тексту, ніж для 26 монограм (літер латинського алфавіту).


== Історія ==

Незважаючи на те, що шифр був винаходом Вітстона, він став відомий як шифр Плейфера. Його перший опис зареєстровано в документі, підписаному Вітстоном 26 березня 1854 року. Друг Вітстона, лорд Лайон Плейфер, рекомендував цей шифр для використання вищими державними й військовими діячами. Однак Міністерство закордонних справ Великої Британії відхилило цей документ через складність його сприйняття. Коли Вітстон запропонував продемонструвати, що троє з чотирьох хлопчиків в сусідній школі навчаться використовувати цей шифр за п'ятнадцять хвилин, заступник міністра закордонних справ відповів: « Це дуже можливо, але ви ніколи не навчите цьому аташе».
Шифр використовувався в тактичних цілях британськими збройними силами у Другій Англо-бурській і в Першій світовій війні, а також  австралійцями і  німцями під час  Другої світової війни. Військові обирали його через те, що шифр Плейфера достатньо простий і не потребує ніякого обладнання, крім олівця і паперу. Проте таким способом найчастіше засекречували лише некритичні повідомлення безпосередньо під час бою. Ворожі криптоаналітики могли зламати шифр за кілька годин, але до того часу перехоплена інформація втрачала актуальність.
Уперше алгоритм злому шифру Плейфера описав у 1914 році лейтенант Джозеф О. Моуборн у брошурі обсягом 19 сторінок. Сучасні комп'ютери можуть зламати цей шифр за кілька секунд, тому його більше не використовують.


== Опис шифру Плейфера ==
Шифр Плейфера використовує матрицю 5х5 (для латинського алфавіту, для кириличного алфавіту можливо збільшити розмір матриці до 4х8), що містить ключове слово або фразу. Для створення матриці й використання шифру досить запам'ятати ключові слова й чотири простих правила. Щоб скласти ключову матрицю, в першу чергу потрібно заповнити порожні клітинки матриці буквами ключового слова (без запису символів, які повторюються), потім заповнити пусті клітинки матриці символами алфавіту, що не зустрічаються в ключовому слові, по порядку (в англійських текстах зазвичай опускається символ «Q», щоб зменшити алфавіт, в інших версіях «I» і «J» об'єднуються в одну клітинку). Ключове слово можна записувати у верхніх рядках матриці зліва направо, або якимось іншим чином, наприклад, по спіралі з лівого верхнього кута до центру. Ключове слово, доповнене алфавітом, становить матрицю 5х5 і є ключем шифру.
Для того щоб зашифрувати повідомлення, необхідно розбити його на біграми (групи з двох символів), наприклад «Hello World» стає «HE LL OW OR LD», і відшукати ці біграми в таблиці. Два символи біграми відповідають протилежним кутам прямокутника в ключовий матриці. Визначаємо положення кутів цього прямокутника відносно один одного. Потім, керуючись наступними 4 правилами, зашифровуємо пари символів вихідного тексту:
1. Якщо два символи біграми збігаються (або якщо залишився один символ), додаємо після першого символу «Х», зашифровуємо нову пару символів і продовжуємо. У деяких варіантах шифру Плейфера замість «Х» використовується «Q».
2. Якщо символи біграми вихідного тексту зустрічаються в одному рядку, то ці символи замінюються на символи, розташовані в найближчих стовпцях праворуч від відповідних символів. Якщо символ є останнім в рядку, то він замінюється на перший символ цього ж рядка.
3. Якщо символи біграми вихідного тексту зустрічаються в одному стовпці, то вони перетворюються в символи того ж стовпця, що знаходяться безпосередньо під ними. Якщо символ є нижнім в стовпці, то він замінюється на перший символ цього ж стовпця.
4. Якщо символи біграми вихідного тексту знаходяться в різних стовпчиках і різних рядках, то вони замінюються на символи, що знаходяться в тих же рядках, але відповідні іншим кутам прямокутника.
Для розшифровки необхідно використовувати інверсію цих чотирьох правил, відкидаючи символи «Х» (або «Q»), якщо вони не несуть сенсу в початковому повідомленні.


=== Ілюстрація правил ===
Припустимо, що необхідно зашифрувати біграму OR. Розглянемо 4 випадки:


== Приклад ==
Розглянемо наступний приклад. Нехай ключовим словом є WHEATSTONE, тоді отримуємо матрицю:

Зашифруємо повідомлення «IDIOCY OFTEN LOOKS LIKE INTELLIGENCE». Для цього розіб'ємо повідомлення на біграми: ID IO CY OF TE NL OO KS LI KE IN TE LL IG EN CE
Оскільки сьома біграма містить повторювані букви, то необхідно вставити X між ними. тоді
ID IO CY OF TE NL OX OK SL IK EI NT EL LI GE NC E
Для того, щоб останній елемент став біграмою потрібно додати в кінець X.
ID IO CY OF TE NL OX OK SL IK EI NT EL LI GE NC EX
Тепер застосовуючи описані вище правила, шифруємо кожну біграмму по черзі.
Текст: ID IO CY OF TE NL OX OK SL IK EI NT EL LI GE NC EX
Шифр: KF FB BZ FM WA SP NV CF DU KD AG CE WP QD PN BS NE
Таким чином повідомлення «IDIOCY OFTEN LOOKS LIKE INTELLIGENCE» перетвориться в
«KFFBBZFMWASPNVCFDUKDAGCEWPQDPNBSNE».


== Криптоаналіз шифру Плейфера ==
Як і більшість шифрів формальної криптографії, шифр Плейфера може бути легко зламаний, якщо є достатній обсяг тексту. Якщо відомий і зашифрований, і відкритий текст, то ключ отримати дуже просто. Коли відомий тільки зашифрований текст, криптоаналітики аналізують відповідність між частотою появи біграм у зашифрованому тексті і відомою частотою появи біграм у мові, на якій написано повідомлення.
Вперше алгоритм злому шифру Плейфера був описаний в брошурі лейтенанта Джозефа О. Моуборнома в 1914 році. Пізніше, в 1939 році, криптоаналіз шифру був наведений в книзі  Х. Ф. Гейнс «Cryptanalysis — a study of ciphers and their solution». Однак більш докладний посібник для знаходження ключа для шифру Плейфера можна знайти в розділі 7 «Solution to polygrafic substitution systems» керівництваField Manual 34-40-2 [Архівовано 3 квітня 2019 у Wayback Machine.] Сухопутних Військ США.
Шифр Плейфера зломується подібно до шифру двох квадратів, але простіше. Для цього застосовується кілька закономірностей. Найважливіша — це те, що у зашифрованому тексті пряма і обернена біграми (AB і BA) відповідають іншій прямій і оберненій біграмі у відкритому тексті (наприклад RE і ER). В англійській мові є багато слів, що містять такі інверсні біграми, наприклад REceivER і DEpartED — це зручна зачіпка для початку криптоаналізу. У зашифрованому тексті відшукуються близькі обернені біграми, для них шукаються відповідники зі списку відомих слів відкритого тексту. Це дозволяє відтворити частину вихідного тексту і почати конструювати ключа.
Існує інший підхід до криптоанаіизу шифру Плейфера, за допомогою Алгоритм сходження на вершину. Він починається із матриці випадкових символів. За допомогою найпростіших ітерацій матриця випадкових символів максимально наближається до оригінальної матриці. Очевидно, що цей метод дуже складний для людини, але комп'ютери за допомогою такого алгоритму можуть зламати шифр, навіть маючи невеликий обсяг тексту. 
Шифр Плейфера можна відрізнити від шифру двох квадратів за тою ознакою, що в ньому ніколи не зустрічаються біграми з повторюваними символами (наприклад ЇЇ). Якщо в зашифрованому тексті відсутні біграми з повторюваними символами і його довжина досить велика, то можна припустити, що вихідний текст зашифрований шифром Плейфера.
Німецька армія, ВВС і поліція використовували подвійну систему шифрування Плейфера у Другій світовій війні як шифр «середнього ґатунку». Вони додали другий квадрат, оскільки під час Першої світової війни шифр Плейфера був зламаний. З цього квадрата брали другий символ кожної біграми, не використовуючи ключове слово й поміщаючи символи в довільному порядку. Але і цей шифр був зламаний в Блечлі-парку, тому що німці використовували один і той же шаблон повідомлення. У восьми повідомленнях, зашифрованих подвійним шифром Плейфера, були використані числа від одного до дванадцяти записані літерами, це і дало можливість досить легко зламати його.
Пізніше були зроблені спроби удосконалити шифр за допомогою використання матриці 7x4 і додаванням символів «*» і «#». Незважаючи на те, що аналіз шифру ускладнився, його все одно можна зламати тими ж методами, що і початковий.


== Згадки в культурі ==
У новелі « Have His Carcase» автора Дороті Лі Сейєрс наведено детальний опис механізму шифрування методом Плейфера, а також і покрокову інструкцію із його криптоаналізу.
У книзі «The Trojan Horse» автора  Хаммонда Іннеса шифр Плейфера використовується для приховування формули нового високоміцного сплаву.
У фільмі «Скарб нації 2: Книга Таємниць» ключ від скарбів закодований шифром Плейфера.


== Посилання ==
Шифр Плейфера [Архівовано 18 квітня 2018 у Wayback Machine.]


== Примітки ==


== Література ==
Friedrich L.Bauer Decrypted Secrets: Methods and Maxims of Cryptolog, Springer, 1997
William Stallings Cryptography and Network Security: Principles and Practice, Pearson,2011
Henk C.A. van Tilbor Fundamentals of Cryptology: A Professional Reference and Interactive Tutoriale, Kluwer Academic Publishers,2000